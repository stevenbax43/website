{% extends 'home/base.html'%}
{% load static %}

{% block extra_css %}
<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css">
<link rel="stylesheet" href="{% static 'tools/styles/tools.css'%}">
<link rel="stylesheet" href="{% static 'tools/styles/tool_E_1.css'%}">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css">
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
{% endblock %}

{% block content_wrapper_start %}{% endblock %}
{% block content_wrapper_end %}{% endblock %}

{% block content %}
{% csrf_token %}

<!-- HERO -->
<header class="tools-hero py-3 text-white">
  <div class="container">
    <div class="d-flex flex-wrap justify-content-between align-items-center">
      <h1 class="h3 mb-2 mb-lg-0">Tool E1: Actief- &amp; schijnbaar vermogen</h1>
      <a href="{% url 'tools:tools' %}" class="d-inline-block">
        <img src="{% static 'tools/images/engineering.png' %}" alt="Engineering" class="hero-icon">
      </a>
    </div>
  </div>
</header>

<!-- INTRO -->
<section class="bg-light py-3 no-print">
  <div class="container">
    <div class="row align-items-center g-3">
      <div class="col-12 col-lg-8">
        <p class="mb-0">
          Door het schuiven van de slides kan de spanning, de stroom en de vermogensfactor veranderd worden
          met als uitkomst het actief-, schijnbaar- en blind vermogen.
        </p>
      </div>
      <div class="col-12 col-lg-4 d-flex justify-content-lg-end align-items-center gap-3 flex-wrap">
        <a href="{% url 'tools:tool-readme' 'E1' %}" target="_blank" rel="noopener"
           class="intro-link d-inline-flex align-items-center gap-2">
          ReadMe <img src="{% static 'tools/images/PDF-icon.png' %}" class="icon-30" alt="PDF">
        </a>
        <a href="#" id="printButton" class="intro-link d-inline-flex align-items-center">
          <img src="{% static 'tools/images/print.png' %}" class="icon-30" alt="Print">
        </a>
        <a href="#" id="excelButton" class="intro-link d-inline-flex align-items-center">
          <img src="{% static 'tools/images/Excel.png' %}" class="icon-30" alt="Excel">
        </a>
      </div>
    </div>
  </div>
</section>

<!-- MAIN -->
<section class="py-3">
  <div class="container">

    <!-- Sliders + Results -->
    <div class="row g-4">
      <div class="col-12 col-lg-8">
        <div class="card card-input shadow-sm" data-chip="Input">
          <div class="card-body">
            <!-- Spanning -->
            <div class="mb-4">
              <label class="form-label">Spanning [V]</label>
              <div class="row g-2 align-items-center slider-controls">
                <div class="col-4 col-sm-3">
                  <input type="number" id="slider-value1" class="form-control" value="400">
                </div>
                <div class="col">
                  <input type="range" id="U_spanning" name="U_spanning" min="0" max="500" value="400" step="1" class="form-range">
                </div>
              </div>
            </div>
            <!-- Stroom -->
            <div class="mb-4">
              <label class="form-label">Stroom [A]</label>
              <div class="row g-2 align-items-center slider-controls">
                <div class="col-4 col-sm-3">
                  <input type="number" id="slider-value2" class="form-control" value="300">
                </div>
                <div class="col">
                  <input type="range" id="I_stroom" name="I_stroom" min="0" max="500" value="300" step="1" class="form-range">
                </div>
              </div>
            </div>
            <!-- Vermogensfactor -->
            <div>
              <label class="form-label">Vermogensfactor [cos(Ï†)]</label>
              <div class="row g-2 align-items-center slider-controls">
                <div class="col-4 col-sm-3">
                  <input type="number" id="slider-value3" class="form-control" min="0" max="1" step="0.01" value="0.85">
                </div>
                <div class="col">
                  <input type="range" id="Phi_factor" name="Phi_factor" min="0" max="1" value="0.85" step="0.01" class="form-range">
                </div>
              </div>
            </div>
          </div>
        </div>
      </div><!-- /col -->

      <div class="col-12 col-lg-4">
        <div class="card card-output shadow-sm" data-chip="Output">
          <div class="card-body">
            <div class="value-container">
              <label class="fw-semibold" style="color:#0d6efd;">Actief vermogen (P)</label>
              <div class="align-left-right">
                <span>kW</span>
                <p id="P_actief" class="result"></p>
              </div>

              <label class="fw-semibold" style="color:#dc3545;">Schijnbaar vermogen (S)</label>
              <div class="align-left-right">
                <span>kVA</span>
                <p id="S_schijn" class="result"></p>
              </div>

              <label class="fw-semibold" style="color:#fd7e14;">Blind vermogen (Q)</label>
              <div class="align-left-right">
                <span>kVAr</span>
                <p id="B_blind" class="result"></p>
              </div>
            </div>
          </div>
        </div>
      </div><!-- /col -->
    </div><!-- /row -->

    <!-- Vector diagram -->
    <div class="row g-4 mt-1">
      <div class="col-12">
        <div class="card card-output shadow-sm" data-chip="Output">
          <div class="card-body">
            <h5 class="card-title mb-3">Vector diagram</h5>
            <div class="ratio ratio-16x9">
              <!-- Keep the same ID so your JS keeps working -->
              <canvas id="arrowCanvas" width="800" height="550"></canvas>
            </div>
          </div>
        </div>
      </div>
    </div>

  </div>
</section>
{% endblock %}

{% block extra_js %}
<script src="{% static 'tools/scripts/script_tools_E1.js' %}"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
<script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
<script>pdfUrlExcel = "{% static 'tools/files/TOOL_E1_Vermogen.xlsx'%}"</script>
{% endblock %}
